---
title: "Campaign Narrative"
author: Ella Trembanis
date: '2024-12-07'
output:
  html_document:
    df_print: paged
categories: []
tags: []
slug: "campaign-narrative"
---

```{r load libraries, echo=FALSE, include=FALSE, warning=FALSE}
library(censable)
library(geofacet)
library(ggpubr)
library(ggthemes)
library(haven)
library(kableExtra)
library(maps)
library(mgcv)
library(mgcViz)
library(RColorBrewer)
library(readstata13)
library(scales)
library(sf)
library(spData)
library(stargazer)
library(tidygeocoder)
library(tidyverse)
library(tigris)
library(tmap)
library(tmaptools)
library(viridis)
```

```{r custom theme, echo=FALSE, include=FALSE, warning=FALSE}
my_theme <- function() {
  theme(
  # set panel features
  panel.border = element_rect(color = "#000033", fill = NA, linetype = 1),
  panel.background = element_rect(fill = "#FFFFFF"),
  panel.grid.major.x = element_line(color = "#9999CC", linetype = 2, size = 0.2),
  panel.grid.minor.x = element_blank(),
  panel.grid.major.y = element_line(color = "#9999CC", linetype = 2, size = 0.2),
  panel.grid.minor.y = element_blank(),
  # set text and axis features
  text = element_text(color = "#000033", family = "Courier"),
  title = element_text(color = "#000033", face = "bold", family = "Courier"),
  axis.ticks = element_line(color = "#000033"),
  # set legend features
  legend.position = "bottom",
  legend.background = element_rect(color = "#000033", fill = NA, linetype = 1)
  )
}
```

```{r simplified custom theme, echo=FALSE, include=FALSE, warning=FALSE}
my_map_theme <- function() {
  theme(
    # set panel features
    panel.background = element_rect(fill = "#FFFFFF"),
    # set text features
    text = element_text(color = "#000033", family = "Courier"),
    title = element_text(color = "#000033", face = "bold", family = "Courier"),
    # set legend features
    legend.position = "bottom",
    legend.title.position = "top",
    legend.background = element_rect(color = "#000033", fill = NA, linetype = 1),
    # set axis features to not display
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  )
}
```

```{r read data, echo=FALSE, include=FALSE, warning=FALSE}
# Read 2024 results datasets. 
d_state_2024 <- read_csv("/Users/ellatrembanis/Desktop/Gov 1347/election-blog/election-blog/Week10/data/state_votes_pres_2024.csv")[-1, 1:6]
d_county_2024 <- read_csv("/Users/ellatrembanis/Desktop/Gov 1347/election-blog/election-blog/Week10/data/county_votes_pres_2024.csv")[-1, 1:6]
d_county_2020 <- read_csv("/Users/ellatrembanis/Desktop/Gov 1347/election-blog/election-blog/Week10/data/county_votes_pres_2020.csv")[-1, 1:6]

# Process 2024 state and county-level data. 
d_state_2024 <- d_state_2024 |> 
  mutate(FIPS = as.numeric(FIPS), 
         votes_trump = as.numeric(`Donald J. Trump`), 
         votes_harris = as.numeric(`Kamala D. Harris`), 
         votes = as.numeric(`Total Vote`), 
         trump_pv = votes_trump/votes, 
         harris_pv = votes_harris/votes, 
         trump_2pv = votes_trump/(votes_trump + votes_harris), 
         harris_2pv = votes_harris/(votes_trump + votes_harris)) |> 
  mutate(winner = case_when(votes_trump > votes_harris ~ "REP", 
                            .default = "DEM")) |> 
  select(FIPS, `Geographic Name`, `Geographic Subtype`, votes_trump, votes_harris, votes, 
         winner, trump_pv, harris_pv, trump_2pv, harris_2pv)

d_county_2024 <- d_county_2024 |>
  mutate(FIPS = as.numeric(FIPS),
         votes_trump = as.numeric(`Donald J. Trump`), 
         votes_harris = as.numeric(`Kamala D. Harris`), 
         votes = as.numeric(`Total Vote`), 
         trump_pv = votes_trump/votes, 
         harris_pv = votes_harris/votes, 
         trump_2pv = votes_trump/(votes_trump + votes_harris), 
         harris_2pv = votes_harris/(votes_trump + votes_harris)) |> 
  mutate(winner = case_when(votes_trump > votes_harris ~ "REP", 
                            .default = "DEM")) |> 
  select(FIPS, `Geographic Name`, `Geographic Subtype`, votes_trump, votes_harris, votes, 
         winner, trump_pv, harris_pv, trump_2pv, harris_2pv)

d_county_2020 <- d_county_2020 |> 
  mutate(FIPS = as.numeric(FIPS),
         votes_trump_2020 = as.numeric(`Donald J. Trump`), 
         votes_biden_2020 = as.numeric(`Joseph R. Biden Jr.`), 
         votes_2020 = as.numeric(`Total Vote`), 
         trump_pv_2020 = votes_trump_2020/votes_2020, 
         biden_pv_2020 = votes_biden_2020/votes_2020, 
         trump_2pv_2020 = votes_trump_2020/(votes_trump_2020 + votes_biden_2020), 
         biden_2pv_2020 = votes_biden_2020/(votes_trump_2020 + votes_biden_2020)) |> 
  mutate(winner_2020 = case_when(votes_trump_2020 > votes_biden_2020 ~ "REP", 
                            .default = "DEM")) |> 
  select(FIPS, `Geographic Name`, `Geographic Subtype`, votes_trump_2020, votes_biden_2020, votes_2020, 
         winner_2020, trump_pv_2020, biden_pv_2020, trump_2pv_2020, biden_2pv_2020)
```

```{r map set-up, echo=FALSE, include=FALSE, warning=FALSE}
# Sequester state and county-level map.
states_2024 <- states(cb = TRUE, year = 2023) |> 
  shift_geometry() |> 
  mutate(GEOID = as.numeric(GEOID)) |> 
  left_join(d_state_2024, by = c("GEOID" = "FIPS")) |> 
  drop_na()
counties_2024 <- counties(cb = TRUE, resolution = "5m", year = 2023) |> 
  shift_geometry() |> 
  mutate(GEOID = as.numeric(GEOID)) |> 
  left_join(d_county_2024, by = c("GEOID" = "FIPS")) |> 
  left_join(d_county_2020, by = c("GEOID" = "FIPS")) |>
  mutate(shift = (trump_pv - trump_pv_2020) * 100, 
         shift_dir = case_when(shift > 0 ~ "REP", 
                               shift < 0 ~ "DEM", 
                               TRUE ~ "No Change"),
         centroid = st_centroid(geometry), 
         centroid_long = st_coordinates(centroid)[,1],
         centroid_lat = st_coordinates(centroid)[,2],
         scale_factor = 1e4, 
         end_long = centroid_long + scale_factor * shift,
         end_lat = centroid_lat + scale_factor * shift) |>
  drop_na()
county_pop_2024 <- read_csv("/Users/ellatrembanis/Desktop/Gov 1347/election-blog/election-blog/Week10/data/PopulationEstimates.csv") |> 
  mutate(FIPStxt = as.numeric(FIPStxt)) |>
  select(FIPStxt, POP_ESTIMATE_2023)
counties_2024 <- counties_2024 |> 
  left_join(county_pop_2024, by = c("GEOID" = "FIPStxt"))
```

```{r ne table code, echo=FALSE, include=FALSE, warning=FALSE}
ne_results <- tibble(`Unit of Analysis` = c("Statewide", "CD-1", "CD-2", "CD-3"),
                     "Harris Two-Party Vote Share" = c(39.38, 43.41, 52.33, 22.77),
                     "My Prediction" = c("40.19", "NA", "NA", "NA"),
                     "538's Prediction" = c(41.3, 41.6, 53.5, 22.6))

ne_table <- knitr::kable(ne_results)
```

```{r ne map code, echo=FALSE, include=FALSE, warning=FALSE}
# Check county-level shifts in Nebraska between 2024 and 2020. 
ne_map <- counties_2024 |> 
  filter(STATE_NAME == "Nebraska") |> 
  ggplot() +
  geom_sf(fill = "#FCFCFC", color = "#000033") +  # Base map
  geom_label(aes(x = centroid_long, y = centroid_lat-1e4, label = NAME),
            size = 2,  # Adjust size as needed
            color = "black", hjust = 0.5, vjust = -0.005) + 
  geom_curve(aes(x = centroid_long, 
                 y = centroid_lat,
                 xend = end_long, 
                 yend = end_lat,
                 color = shift_dir),
             arrow = arrow(length = unit(0.1, "cm"), type = "closed"),  # Smaller arrowhead
             curvature = 0.2,  # Add a slight curve to each arrow
             size = 0.3) +
  scale_color_manual(values = c("DEM" = "#7CB9E8", "REP" = "#FF6680")) +
  my_map_theme() +
  labs(title = "Presidential Voting Shifts by County (2020-2024)")
```

# Campaigning in the Cornhusker State



```{r print ne table, echo=FALSE, include=TRUE, warning=FALSE}
ne_table
```

```{r print ne map, echo=FALSE, include=TRUE, warning=FALSE}
ne_map
```

# Nebraska: An Overview

## Demographics, Geography, & Electoral History

## Red State, "Blue Dot"

## Down-Ballot Candidates & Ballot Initiatives


# 2024 Campaign Activity



# Conclusions



# References

Ballotpedia. (n.d.) Nebraska elections, 2024. Accessed December 7, 2024. https://ballotpedia.org/Nebraska_elections,_2024

Deuel County, Nebraska. (2024, November 6). Summary Results Report. https://countyelectionresults.nebraska.gov/election_files/Deuel/2024_General_official_results.pdf

FiveThirtyEight. (2024, November 5). Who Is Favored To Win Nebraska's 1st District's 1 Electoral Vote? ABC News. https://projects.fivethirtyeight.com/2024-election-forecast/nebraska-1/

FiveThirtyEight. (2024, November 5). Who Is Favored To Win Nebraska's 2 Electoral Votes? ABC News. https://projects.fivethirtyeight.com/2024-election-forecast/nebraska/

FiveThirtyEight. (2024, November 5). Who Is Favored To Win Nebraska's 2nd District's 1 Electoral Vote? ABC News. https://projects.fivethirtyeight.com/2024-election-forecast/nebraska-2/

FiveThirtyEight. (2024, November 5). Who Is Favored To Win Nebraska's 3rd District's 1 Electoral Vote? ABC News. https://projects.fivethirtyeight.com/2024-election-forecast/nebraska-3/

Kimball County, Nebraska. (2024, November 6). Kimball County General Election Results. https://irp.cdn-website.com/82f946ac/files/uploaded/General_Election_Results-Pres_2024-c4b5ed95.pdf

NPR. (2024, December 5). Nebraska Election Results. https://apps.npr.org/2024-election-results/nebraska.html?section=P
